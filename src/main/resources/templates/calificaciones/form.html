<!-- Registration Page HTML Template -->
<!-- Purpose:
     - Provides a user interface for new users to create an account on ServiExpress.
     - Handles input fields, validation error display, CSRF protection, and password visibility toggling.
     - Uses Thymeleaf for server-side template rendering. -->
<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Document metadata and linked stylesheet -->
    <meta charset="utf-8">
    <title>Crear cuenta</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">

    <!-- Internal CSS for registration page styling -->
    <style>
        /* ===================== THEME COLORS ===================== */
        /* Define color variables for the page theme */
        :root { --bg:#f6ece3; --card:#fff; --stroke:#ead8ce; --text:#2b2b2b; --muted:#9a7d72; --brand:#c77462; }

        /* ===================== GLOBAL STYLES ===================== */
        *{box-sizing:border-box} /* Box model configuration for all elements */

        /* Main body styling: full viewport height, centered content, default font */
        body{
            min-height:100vh;
            margin:0;
            display:grid;
            place-items:center;
            background:var(--bg);
            font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
            color:var(--text);
        }

        /* ===================== CARD STYLING ===================== */
        /* Main card container */
        .card{
            width:min(560px,94vw); /* Responsive width */
            background:var(--card);
            border:1px solid var(--stroke);
            border-radius:16px;
            box-shadow:0 12px 28px rgba(0,0,0,.06);
        }
        .body{padding:28px} /* Inner padding for content inside card */
        h1{margin:0 0 10px} /* Main heading spacing */

        /* ===================== FORM ELEMENTS ===================== */
        .group{margin:14px 0} /* Spacing between input fields */
        label{font-weight:600;display:block;margin:0 0 6px} /* Labels styling */
        input{
            width:100%;
            padding:12px 14px;
            border:1px solid #dec6bb;
            border-radius:12px;
            font-size:1rem;
        }

        /* ===================== ROW LAYOUT ===================== */
        .row{display:flex;gap:12px;margin-top:14px} /* Horizontal layout for multiple fields */
        .row.two > *{flex:1} /* Equal width for two-column layouts */

        /* ===================== BUTTONS ===================== */
        .btn{
            border-radius:12px;
            padding:12px 16px;
            font-weight:700;
            border:1px solid var(--brand);
            cursor:pointer;
        }
        .btn.primary{background:var(--brand);color:#fff} /* Primary action button */
        .btn.ghost{background:transparent;color:var(--brand)} /* Secondary/ghost button */

        /* ===================== ERROR MESSAGES ===================== */
        .error{color:#8b1a1a;font-size:.9rem;margin-top:6px} /* Field-level validation errors */
        .alert{
            padding:12px 14px;
            border-radius:12px;
            margin:10px 0;
            background:#fde8e8;
            border:1px solid #f4b4b4;
            color:#8b1a1a;
        } /* Global validation errors container */

        /* ===================== PASSWORD TOGGLE ===================== */
        .pw-toggle{
            position:absolute;
            right:12px;
            top:50%;
            transform:translateY(-50%);
            cursor:pointer;
            font-size:.9rem;
            color:var(--muted);
        } /* Icon/button to toggle password visibility */
        .pw-wrap{position:relative} /* Container to position toggle icon relative to input */
    </style>
</head>

<body>
<!-- ===================== MAIN CARD ===================== -->
<div class="card">
    <div class="body">
        <!-- Page title -->
        <h1>Crear cuenta</h1>
        <!-- Short description for the user -->
        <p style="color:var(--muted);margin-top:0">Regístrate para empezar a usar ServiExpress.</p>

        <!-- ===================== GLOBAL FORM ERRORS ===================== -->
        <div class="alert" th:if="${#fields.hasGlobalErrors()}"
             th:each="e : ${#fields.globalErrors()}" th:text="${e}">Hay errores en el formulario.</div>
        <!-- Displays any server-side or form-wide validation errors -->

        <!-- ===================== REGISTRATION FORM ===================== -->
        <form th:action="@{/auth/registro}" th:object="${form}" method="post" novalidate>

            <!-- Field: Name -->
            <div class="group">
                <label for="nombreUsuario">Nombre</label>
                <input id="nombreUsuario" th:field="*{nombreUsuario}" placeholder="Tu nombre"
                       maxlength="80" autocomplete="name" required>
                <div class="error" th:if="${#fields.hasErrors('nombreUsuario')}" th:errors="*{nombreUsuario}"></div>
            </div>

            <!-- Field: Email -->
            <div class="group">
                <label for="correo">Correo</label>
                <input id="correo" type="email" th:field="*{correo}" placeholder="tucorreo@dominio.com"
                       maxlength="120" autocomplete="email" required>
                <div class="error" th:if="${#fields.hasErrors('correo')}" th:errors="*{correo}"></div>
            </div>

            <!-- Row with two columns: Phone and City -->
            <div class="row two">
                <!-- Field: Phone -->
                <div class="group">
                    <label for="telefono">Teléfono</label>
                    <input id="telefono" th:field="*{telefono}" placeholder="300 123 4567"
                           inputmode="tel" autocomplete="tel" required>
                    <div class="error" th:if="${#fields.hasErrors('telefono')}" th:errors="*{telefono}"></div>
                </div>

                <!-- Field: City -->
                <div class="group">
                    <label for="ciudad">Ciudad</label>
                    <input id="ciudad" th:field="*{ciudad}" placeholder="Tu ciudad"
                           maxlength="100" autocomplete="address-level2" required>
                    <div class="error" th:if="${#fields.hasErrors('ciudad')}" th:errors="*{ciudad}"></div>
                </div>
            </div>

            <!-- Field: Password -->
            <div class="group">
                <label for="password">Contraseña</label>
                <div class="pw-wrap">
                    <input id="password" type="password" th:field="*{password}" minlength="6" maxlength="120"
                           autocomplete="new-password" required>
                    <span class="pw-toggle" data-target="password">mostrar</span>
                    <!-- Toggle password visibility -->
                </div>
                <div class="error" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
            </div>

            <!-- Field: Confirm Password -->
            <div class="group">
                <label for="confirmarPassword">Confirmar contraseña</label>
                <div class="pw-wrap">
                    <input id="confirmarPassword" type="password" th:field="*{confirmarPassword}" minlength="6" maxlength="120"
                           autocomplete="new-password" required>
                    <span class="pw-toggle" data-target="confirmarPassword">mostrar</span>
                </div>
                <div class="error" th:if="${#fields.hasErrors('confirmarPassword')}" th:errors="*{confirmarPassword}"></div>
            </div>

            <!-- CSRF security token -->
            <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

            <!-- Action buttons -->
            <div class="row">
                <a class="btn ghost" th:href="@{/auth/login}">Ya tengo cuenta</a>
                <!-- Link to login page for existing users -->
                <button class="btn primary" type="submit">Crear cuenta</button>
                <!-- Submit registration form -->
            </div>
        </form>
    </div>
</div>

<!-- ===================== PASSWORD TOGGLE SCRIPT ===================== -->
<script>
    /* Script to toggle visibility for password and confirm password fields */
    document.querySelectorAll('.pw-toggle').forEach(t => {
        t.addEventListener('click', () => {
            const id = t.getAttribute('data-target'); // Target input field ID
            const input = document.getElementById(id);
            const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
            input.setAttribute('type', type);
            t.textContent = type === 'password' ? 'mostrar' : 'ocultar'; // Update toggle text
        });
    });
</script>
</body>
</html>

<!-- Technical Summary:
This HTML file defines the registration page for ServiExpress. It provides a card-based form layout
with fields for name, email, phone, city, password, and password confirmation. Server-side and field-level
validation messages are displayed. The password fields have a toggle feature for visibility. CSRF protection
is included via a hidden input. Thymeleaf is used for template rendering and form binding.
-->
